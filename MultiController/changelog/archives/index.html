<!DOCTYPE html>
<html>
<head>
    <title>Archives</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
</head>
<body>
    <nav class="navbar navbar-dark bg-dark navbar-expand-lg">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link" href="../../">Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="../">Changelog</a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" href="">Archives</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="../../controls">Controls</a>
            </li>
        </ul>
    </nav>
    <div class="w-100" style="height:15px;"></div>
    <div id="maincont" class="container">
        <script>
            var releases = {
                1: [],
                0: []
            };
    
            fetch("https://api.github.com/repos/saltytt/MultiController/tags").then(function(res) {
                res.json().then(function(r) {
                    for(var i = 0; i < r.length; i++)
                        releases[r[i]["name"][1]] = releases[r[i]["name"][1]].concat(r[i]["name"]);
    
                    var majors = Object.keys(releases).sort().reverse();
                    var maincont = document.getElementById("maincont");
                    maincont.innerHTML = '<div class="w-100" style="height:15px;"></div>';

                    for(var i = 0; i < majors.length; i++) {
                        var block = document.createElement("ul");
                        block.innerHTML = '<li class="list-group-item list-group-item-dark"><strong> ' + majors[i] + '</strong></li>';
                        block.setAttribute("class", "list-group");
                        maincont.appendChild(block);
                        for(var j = 0; j < releases[majors[i]].length ; j++) {
                            var versionname = releases[majors[i]][j];
                            var versionclean = versionname.substring(1);
                            if (versionclean.includes("_"))
                                versionclean = versionclean.replace("_", " (").concat(")");
                            var versionurl = versionname.substring(1).replace(/\./g,"_");
                            console.log(versionname);
                            if (i == 0 && j == 0)
                                block.innerHTML += '<li class="list-group-item list-group-item-primary"> <strong>' + versionclean + ' ~ </strong><a href="../' + versionurl + '">Changelog</a> - <a href="https://github.com/saltyTT/MultiController/releases/download/' + versionname + '/MultiController.app.zip">Download</a></li>';
                            else
                                block.innerHTML += '<li class="list-group-item"> <strong>' + versionclean + ' ~ </strong><a href="../' + versionurl + '">Changelog</a> - <a href="https://github.com/saltyTT/MultiController/releases/download/' + versionname + '/MultiController.app.zip">Download</a></li>';
                        }
                        maincont.innerHTML += '<div class="w-100" style="height:15px;"></div>';
                    }   
                });
            });
            
        </script>
    </div>

</body>
</html>
